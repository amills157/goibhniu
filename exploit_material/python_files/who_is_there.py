import time
import ipaddress

from socket import *

startTime = time.time()

if __name__ == '__main__':
   target = input('Enter the network to be scanned: ')

   net4 = ipaddress.ip_network(target)

   open_list = []

   for x in net4.hosts():

    t_IP = str(x)

    print ('Starting scan on host: ', t_IP)
    
    for i in [25,53,80,8080,443,4433]:
        s = socket(AF_INET, SOCK_STREAM)

        s.settimeout(1)
        
        conn = s.connect_ex((t_IP, i))
        if(conn == 0) :
            print ('Port %d: OPEN' % (i,))
            open_list.append("{}:{}".format(t_IP, i))
        s.close()

print('Time taken:', time.time() - startTime)

print("Open ports:")
for i in open_list:
    print(i)
