#!/usr/bin/python

# https://gist.github.com/snj/9382c63ad49050e1b9ba

import argparse

from scapy.all import *

def knock(target, ports):
    print("[*] Knocking on ports "+str(ports))
    for dport in range(0, len(ports)):
        ip = IP(dst = target)
        SYN = ip/TCP(dport=ports[dport], flags="S", window=14600, options=[('MSS',1460)])
        send(SYN)

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="CHANGEME")

    parser.add_argument('target', help='Hostname or IP address of the target')

    args = parser.parse_args()

    print(args.target)

    print('knock... knock...')
    knock(args.target, [80,443,8080,4433])
